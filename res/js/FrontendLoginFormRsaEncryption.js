T3FrontendLoginFormRsaEncryption=function(){var t=function(t,e){this.form=t,this.xhr=null,this.publicKeyEndpointUrl=e,this.userPasswordField=t.pass,this.handleFormSubmitRequest=function(){var t=this;this.ajaxCall(this.publicKeyEndpointUrl,function(e){t.handlePublicKeyResponse(e,t)})},this.ajaxCall=function(t,e){if(this.xhr&&this.xhr.abort(),"undefined"!=typeof XMLHttpRequest)this.xhr=new XMLHttpRequest;else for(var s=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],n=0,r=s.length;r>n;n++)try{this.xhr=new ActiveXObject(s[n]);break}catch(i){}this.xhr.onreadystatechange=function(){4===this.readyState&&this.status>0&&e(this)},this.xhr.open("GET",t,!1),this.xhr.send("")},this.handlePublicKeyResponse=function(t,e){var s=t.responseText.split(":");s[0]&&s[1]?e.encryptPasswordAndSubmitForm(s[0],s[1]):alert("No public key could be generated. Please inform your TYPO3 administrator to check the OpenSSL settings.")},this.encryptPasswordAndSubmitForm=function(t,e){var s,n;s=new RSAKey,s.setPublic(t,e),n=s.encrypt(this.userPasswordField.value),this.userPasswordField.value="rsa:"+hex2b64(n),this.form.pass.value=this.userPasswordField.value}};return this.submitForm=function(e,s){if(e.rsaFrontendLogin||(e.rsaFrontendLogin=new t(e,s)),e.pass.value.match(/^rsa:/))return!0;e.rsaFrontendLogin.handleFormSubmitRequest();var n=e.rsaFrontendLogin.userPasswordField.value;return n},this}();